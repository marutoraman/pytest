# Pytestを使ったテスト手法
Pythonではunittestというモジュールが既定で使用できますが、Pytestの方が高機能なため<BR>
こちらをオススメしております。<BR>
参考サイト:https://qiita.com/everylittle/items/1a2748e443d8282c94b2
  
## テストの重要性
テストが品質を左右するといっても過言ではなく、少し大きなシステムになると、モジュール単位でテストをして品質を担保していかないと<BR>
全体としての品質確保が、非常に困難になります。<BR>
また、少しの修正を加えた際に、全体としての影響の有無を調べるのにも役立ちます。
  
## 使い方
### install
```
pip install pytest
```
### テストコードの作成
testの文字列がファイル名に含まれるpyファイルを作成します。<BR>
例）module_test.py  <BR>
※module.pyに対して、上記テストコードを作るイメージ。決まりはないが、pyファイルと１対１の方が分かりやすい。<BR>
  前にtestと付与するよりは、後ろにtestと付与するほうが、整列順を崩さないのでオススメ<BR>

- テストコードの記載
任意の関数名が使用できるが、先頭にtestと付与する必要がある。
```
def test_function1():
   *****

def test_function2():
   *****

```

- テストコードにおける正誤チェック<BR>
assert文を使用して、正誤をチェックし、正であれば通過、誤であればエラーを返す<BR>
```
a = 1
b = 2
assert a == 1 # 正常なので何も起きない
assert a == b # 誤りなのでエラー

# 実用的な使い方
## 作成した関数を実行して、結果が想定通りかをチェックする。
res = function1() # 作成した関数を実行する
assert res.get("data") # res(辞書)にdataというキーが存在すること
assert len(res["data"]) >= 1 # データ数が１以上であること
assert res["data"][0]["nane"] == "想定する名前" # 想定したデータが返ってきていること

```

### 実行コマンド
- 全てのテストを実行
```
python -m pytest
```

- テストコードを指定して実行(コード内の全てのテストを実行)
```
python -m pytest <テストコードのパス>
```

- テスト関数を指定して実行
```
python -m pytest <テストコードのパス>::<テスト関数名>
```

- 正誤に関わらずコンソールにprint文の内容を出力
通常は結果が正の場合はprint文は無視されるので、常に表示させたい場合は<BR>
コマンドの後ろに -s オプションを付与する

# CI/CDへの活用
pytestとCI/CDの仕組みを組み合わせることで自動的なデプロイ運用が可能です。<BR>
あらかじめ設定したテストコードをpush時に全て実行するように指定できるので<BR>
これを通過した場合のみに本番に適用するような運用が可能です。
